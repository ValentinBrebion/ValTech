---
next: false
prev: 
    text: 'Symfony History'
    link: 'language/PHP/Symfony/SymfonyHistory'
---

# Understanding the Hierarchy of a Symfony Application

## Application
::: info *The Symfony application consists of several distinct parts:*
>  Kernel => This is the heart of the Symfony application. It manages configurations, request and response lifecycle.

> Bundles => These are equivalent to plugins or modules. A bundle is a `collection of files that add specific functionalities to the application`.
:::

## Bundles

::: info *Bundles are reusable blocks of functionality. There are two types of bundles:*
>  Third-party bundles => Provided by the community or external developers. They are installed via Composer.

> Custom bundles => Created by developers for application-specific functionalities.
:::

## File Structure

::: info *The typical structure of a Symfony project includes the following directories:*
::: details :file_folder: *src/ : Contains the application source code, including custom bundles.*
>>>:open_file_folder: `Controller/` : Controllers that handle HTTP requests and return appropriate responses.

>>>:open_file_folder: `Entity/` : Entity definitions for ORM (Object-Relational Mapping).

>>>:open_file_folder: `Repository/` : Contains repository classes that manipulate entities.
:::
>:file_folder: config/ : Configuration files for the application and bundles.

>:file_folder: templates/ : Twig template files used for view rendering.

>:file_folder: public/ : Public entry point of the application, often with an index.php file.

>:file_folder: var/ : Files generated by the application, such as logs and cache.

>:file_folder: vendor/ : External dependencies installed via Composer.

## Controllers
Controllers are responsible for processing HTTP requests and returning HTTP responses. ***Each controller method typically corresponds to a specific route.***

## Routes
Routes define how HTTP requests are mapped to controllers. They are configured in configuration files (YAML, XML) or via annotations in controllers.

## Models and Entities
Entities are objects that represent data stored in a database. They are defined in the `Entity/` directory. Repositories provide methods to interact with these entities.

## Services and Dependency Injection
Symfony uses a service container to manage dependencies. Services are reusable objects configured through configuration files. Dependency injection automatically injects these services where they are needed.

::: details Learn more :point_down:
:::tip <h4><u>What is a service?</u></h4>
<p class="italic">A service is like a tool or assistant that performs a specific task for your application. For example, a service can send emails, connect to a database, or process data.</p>

<h4><u>What is dependency injection?</u></h4>
<p class="italic">Dependency injection is a way to give your controllers (or other services) the tools they need without them having to look for them themselves. It's like someone preparing all the materials you need for a DIY project and giving them to you directly.</p>

<h4><u>Concrete example:</u></h4>
Let's imagine we have a service that sends emails. Here's how we'll create and use it in a controller.

1. **<u>Create a Service</u>**<br>
We'll create a service file that handles sending emails. This file will be in the `src/Service` folder.

```php
// src/Service/MailService.php
namespace App\Service;

class MailService
{
    public function sendEmail($to, $subject, $message)
    {
        // Here goes the code to send an email
        // For example, we can use PHP's mail() function
        mail($to, $subject, $message);
    }
}

```
2. **<u>Configure the Service</u>**<br>
We need to tell Symfony that this service exists. For this, we'll add a configuration in a YAML file.

```php
# config/services.yaml
services:
    App\Service\MailService:
        public: true

```
3. **<u>Use the Service in a Controller</u>**<br>
Now, we'll use this service in a controller. A controller is a file that handles user requests.

```php
// src/Controller/RegistrationController.php
namespace App\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;
use Symfony\Component\HttpFoundation\Response;
use App\Service\MailService;

class RegistrationController extends AbstractController
{
    private $mailService;

    // Here, we inject the service into the controller
    public function __construct(MailService $mailService)
    {
        $this->mailService = $mailService;
    }

    public function register(): Response
    {
        // Code to register a user

        // Use the service to send an email
        $this->mailService->sendEmail('user@example.com', 'Welcome!', 'Thanks for registering!');

        return new Response('User registered and email sent!');
    }
}
```
:::

## Templates and Twig
Twig is Symfony's default template engine. Twig files, located in the templates/ directory, are used for view rendering.

## Summary
```lua
my_project/
|-- config/
|   |-- packages/
|   |-- routes/
|   |-- services.yaml
|-- public/
|   |-- index.php
|-- src/
|   |-- Controller/
|   |   |-- DefaultController.php
|   |-- Entity/
|   |   |-- User.php
|   |-- Repository/
|   |   |-- UserRepository.php
|   |-- Kernel.php
|-- templates/
|   |-- base.html.twig
|   |-- default/
|       |-- index.html.twig
|-- var/
|   |-- cache/
|   |-- log/
|-- vendor/
|-- composer.json
``` 